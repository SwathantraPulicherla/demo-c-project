# Demo C Project

A sample C project demonstrating temperature sensor and converter functionality. This project is designed to work with the AI C Test Generator tool.

## Project Structure

```
demo-c-project/
├── src/
│   ├── main.c           # Main application entry point
│   ├── temp_sensor.c    # Temperature sensor implementation
│   ├── temp_sensor.h    # Temperature sensor header
│   ├── temp_converter.c # Temperature conversion utilities
│   └── temp_converter.h # Temperature converter header
├── tests/               # Generated by AI C Test Generator
│   ├── test_main.c
│   ├── test_temp_sensor.c
│   └── test_temp_converter.c
└── README.md
```

## Features

- **Temperature Sensor**: Reads temperature values from sensors
- **Temperature Converter**: Converts between Celsius, Fahrenheit, and Kelvin
- **Main Application**: Demonstrates usage of sensor and converter modules

## Using AI C Test Generator

This project is structured to work seamlessly with the [AI C Test Generator](https://github.com/SwathantraPulicherla/ai-c-test-generator) tool.

### Prerequisites

1. Install the AI C Test Generator:
```bash
pip install ai-c-test-generator
```

2. Set your Gemini API key:
```bash
export GEMINI_API_KEY=your_api_key_here
```

### Generate Tests

```bash
# Navigate to this project directory
cd demo-c-project

# Generate AI-powered unit tests
ai-c-testgen

# Or with custom options
ai-c-testgen --verbose --source-dir src --output tests
```

### What Gets Generated

- **Unit Tests**: Comprehensive Unity framework tests for each C module
- **Stub Functions**: Automatically generated stubs for dependencies
- **Validation Reports**: Detailed quality assessment in `tests/verification_report/`
- **Compilation Checks**: Ensures all generated tests compile correctly

## AI Test Runner Integration

This project includes automated testing and coverage reporting using the [AI Test Runner](https://github.com/SwathantraPulicherla/ai-test-runner) tool.

### Running Tests with AI Test Runner

After generating tests with the AI C Test Generator, use the AI Test Runner to compile, execute, and generate coverage reports:

```bash
# Install AI Test Runner
pip install ai-test-runner

# Run tests with coverage
ai-test-runner --verbose

# Or specify custom paths
ai-test-runner --repo-path . --output build/debug
```

#### Windows Batch File

For Windows users, convenient batch files are available in each tool's directory:

```cmd
# Generate tests (from ai-c-test-generator directory)
ai-c-testgen.bat

# Run tests (from ai-test-runner directory)
ai-test-runner.bat --verbose

# Or run from anywhere using full paths
C:\path\to\ai-c-test-generator\ai-c-testgen.bat
C:\path\to\ai-test-runner\ai-test-runner.bat --verbose
```

### What AI Test Runner Provides

- **Automated Build**: CMake-based compilation with Unity framework
- **Test Execution**: Runs all generated unit tests with detailed reporting
- **Coverage Analysis**: LCOV-based coverage reports with HTML output
- **Cross-Platform**: Works on Windows, macOS, and Linux
- **Individual Test Counting**: Reports individual test functions, not just executables

### GitHub Actions CI/CD

This project includes GitHub Actions workflows for automated testing:

- **Triggers**: Push to main/develop branches, pull requests, manual dispatch
- **Platforms**: Ubuntu, Windows, macOS (matrix testing)
- **Tools**: CMake, Ninja build system, LCOV coverage
- **Reports**: Codecov integration for coverage tracking
- **PR Comments**: Automatic test result comments on pull requests

The workflow automatically:
1. Installs required build tools (cmake, build-essential, lcov)
2. Installs the AI Test Runner package
3. Runs the test suite with coverage analysis
4. Uploads coverage reports to Codecov
5. Comments test results on pull requests

## Building the Project

```bash
# Create build directory
mkdir build && cd build

# Configure with CMake
cmake ..

# Build
make

# Run tests (after generating with AI tool)
make test
```

## Files Description

### Core Modules

- **`temp_sensor.c/h`**: Temperature sensor abstraction layer
  - `read_temperature()`: Reads current temperature
  - `init_sensor()`: Initializes sensor hardware
  - `is_sensor_ready()`: Checks sensor status

- **`temp_converter.c/h`**: Temperature conversion utilities
  - `celsius_to_fahrenheit()`: Convert C to F
  - `fahrenheit_to_celsius()`: Convert F to C
  - `celsius_to_kelvin()`: Convert C to K
  - `kelvin_to_celsius()`: Convert K to C

- **`main.c`**: Main application demonstrating usage

## AI Test Generation Features

When you run `ai-c-testgen` on this project, it will:

1. **Analyze Dependencies**: Map function relationships across modules
2. **Generate Smart Tests**: Create realistic test cases with proper edge cases
3. **Handle Stubs**: Automatically create stub implementations for cross-module calls
4. **Validate Quality**: Ensure tests compile and follow best practices
5. **Report Results**: Provide detailed validation reports

## Example Generated Test

The AI tool will generate tests like:

```c
void test_celsius_to_fahrenheit(void) {
    // Test normal conversion
    TEST_ASSERT_FLOAT_WITHIN(0.01f, 32.0f, celsius_to_fahrenheit(0.0f));

    // Test edge cases
    TEST_ASSERT_FLOAT_WITHIN(0.01f, -40.0f, celsius_to_fahrenheit(-40.0f));
    TEST_ASSERT_FLOAT_WITHIN(0.01f, 212.0f, celsius_to_fahrenheit(100.0f));
}

void test_read_temperature_valid_range(void) {
    // Stub setup for testing
    temperature_stub = 25.5f;
    call_count_read_sensor = 0;

    // Test
    float temp = read_temperature();
    TEST_ASSERT_FLOAT_WITHIN(0.01f, 25.5f, temp);
    TEST_ASSERT_EQUAL(1, call_count_read_sensor);
}
```

## Contributing

This is a demo project for testing the AI C Test Generator. To contribute:

1. Use the AI tool to generate tests
2. Review and improve the generated tests
3. Submit pull requests with enhancements

## License

MIT License - see LICENSE file for details.